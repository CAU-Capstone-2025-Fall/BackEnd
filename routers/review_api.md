---

# Review CRUD API ëª…ì„¸ì„œ

> íŒŒì¼ ê¸°ë°˜(`reviews.json`) ë¦¬ë·° ê´€ë¦¬ API
> ì´ë¯¸ì§€ ì—…ë¡œë“œëŠ” ì„œë²„ì˜ `uploads/` í´ë”ì— ì €ì¥ë˜ë©°, `/static/` ê²½ë¡œë¡œ ì ‘ê·¼ ê°€ëŠ¥í•¨.
> ì¸ì¦ì€ `/auth/protected` ë¼ìš°íŠ¸ë¥¼ ì´ìš©í•œ **ì¿ í‚¤ ê¸°ë°˜ ë¡œê·¸ì¸ ì„¸ì…˜**ìœ¼ë¡œ ì´ë£¨ì–´ì§.

---

## ğŸ“˜ Base URL

```
http://<EC2-PUBLIC-IP>:<PORT>
```

ì˜ˆì‹œ:

```
http://3.36.xx.xx:8000
```

---

## Review ë°ì´í„° êµ¬ì¡°

```json
{
  "_id": "string (uuid)", // ë¦¬ë·° ê³ ìœ  ID
  "title": "string", // ì œëª©
  "body": "string", // ë³¸ë¬¸ ë‚´ìš©
  "images": ["string"], // ì´ë¯¸ì§€ URL ë°°ì—´ (/static/...)
  "authorId": "string", // ì‘ì„±ì ì•„ì´ë””
  "authorName": "string", // ì‘ì„±ì í‘œì‹œ ì´ë¦„
  "createdAt": "string (ISO 8601)", // ì‘ì„±ì¼ì‹œ
  "updatedAt": "string (ISO 8601)" // ìˆ˜ì •ì¼ì‹œ
}
```

> - ëª¨ë“  ë¦¬ë·°ëŠ” `reviews.json`ì— ë°°ì—´ í˜•íƒœë¡œ ì €ì¥ë©ë‹ˆë‹¤.
> - ê° ë¦¬ë·°ëŠ” `_id` í•„ë“œë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. (`uuid4()` ìë™ ìƒì„±)

---

## í›„ê¸° ëª©ë¡ ì¡°íšŒ (List Reviews)

- **URL**: `/reviews`
- **Method**: `GET`
- **Query Params**

  | ì´ë¦„    | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª…           |
  | ------- | ---- | ------ | -------------- |
  | `skip`  | int  | 0      | ê±´ë„ˆë›¸ ê°œìˆ˜    |
  | `limit` | int  | 10     | ìµœëŒ€ ì¡°íšŒ ê°œìˆ˜ |

### ì„±ê³µ ì‘ë‹µ

```json
{
  "items": [
    {
      "_id": "fcdfaa9d-d2c1-4a2f-a7c3-df92b51935a7",
      "title": "ì²« í›„ê¸°",
      "body": "ì´ ê°•ì•„ì§€ëŠ” ì •ë§ ê·€ì—¬ì›Œìš”!",
      "images": ["/static/1696612345_abc123.jpg"],
      "authorId": "user1",
      "authorName": "user1",
      "createdAt": "2025-10-06T12:40:00Z",
      "updatedAt": "2025-10-06T12:40:00Z"
    }
  ],
  "total": 1
}
```

---

## í›„ê¸° ë‹¨ê±´ ì¡°íšŒ (Get Review)

- **URL**: `/reviews/{rid}`
- **Method**: `GET`
- **Path Param**

  | ì´ë¦„  | íƒ€ì…   | ì„¤ëª…         |
  | ----- | ------ | ------------ |
  | `rid` | string | ë¦¬ë·°ì˜ `_id` |

### ì„±ê³µ ì‘ë‹µ

```json
{
  "_id": "fcdfaa9d-d2c1-4a2f-a7c3-df92b51935a7",
  "title": "ì²« í›„ê¸°",
  "body": "ì´ ê°•ì•„ì§€ëŠ” ì •ë§ ê·€ì—¬ì›Œìš”!",
  "images": ["/static/1696612345_abc123.jpg"],
  "authorId": "user1",
  "authorName": "user1",
  "createdAt": "2025-10-06T12:40:00Z",
  "updatedAt": "2025-10-06T12:40:00Z"
}
```

### ì—ëŸ¬ ì‘ë‹µ

```json
{ "detail": "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€" }
```

---

## í›„ê¸° ì‘ì„± (Create Review)

- **URL**: `/reviews`
- **Method**: `POST`
- **ì¸ì¦ í•„ìš”**: (ë¡œê·¸ì¸ ì„¸ì…˜ ì¿ í‚¤ `session`)
- **Body**: `multipart/form-data`

  | í•„ë“œëª…  | íƒ€ì…   | í•„ìˆ˜ | ì„¤ëª…                     |
  | ------- | ------ | ---- | ------------------------ |
  | `title` | string | O    | ì œëª©                     |
  | `body`  | string | X    | ë³¸ë¬¸                     |
  | `files` | file[] | X    | ì´ë¯¸ì§€ ì—¬ëŸ¬ ì¥ ì²¨ë¶€ ê°€ëŠ¥ |

### ì„±ê³µ ì‘ë‹µ

```json
{
  "_id": "4b24de26-3e2e-4f57-a0b0-6fa7f91f0873",
  "title": "ìƒˆë¡œìš´ í›„ê¸°",
  "body": "ê°•ì•„ì§€ ë„ˆë¬´ ê·€ì—½ë„¤ìš”",
  "images": ["/static/1696612501_4b24de26.jpg"],
  "authorId": "user1",
  "authorName": "user1",
  "createdAt": "2025-10-06T13:00:00Z",
  "updatedAt": "2025-10-06T13:00:00Z"
}
```

### ì—ëŸ¬ ì‘ë‹µ

```json
{ "detail": "ë¡œê·¸ì¸ í•„ìš”" }
```

---

## í›„ê¸° ìˆ˜ì • (Update Review)

- **URL**: `/reviews/{rid}`
- **Method**: `PATCH`
- **ì¸ì¦ í•„ìš”**: âœ… (ë¡œê·¸ì¸ ì„¸ì…˜ ì¿ í‚¤ `session`)
- **Body**: `multipart/form-data`

  | í•„ë“œëª…  | íƒ€ì…   | í•„ìˆ˜ | ì„¤ëª…                                      |
  | ------- | ------ | ---- | ----------------------------------------- |
  | `title` | string | X    | ìˆ˜ì •í•  ì œëª©                               |
  | `body`  | string | X    | ìˆ˜ì •í•  ë³¸ë¬¸                               |
  | `files` | file[] | X    | ìƒˆ ì´ë¯¸ì§€ ì²¨ë¶€ ì‹œ ê¸°ì¡´ ì´ë¯¸ì§€ ì „ë¶€ êµì²´ë¨ |

### ì„±ê³µ ì‘ë‹µ

```json
{
  "_id": "4b24de26-3e2e-4f57-a0b0-6fa7f91f0873",
  "title": "ìˆ˜ì •ëœ ì œëª©",
  "body": "ë³¸ë¬¸ë„ ìˆ˜ì •ë¨",
  "images": ["/static/1696613000_newimg.jpg"],
  "authorId": "user1",
  "authorName": "user1",
  "createdAt": "2025-10-06T13:00:00Z",
  "updatedAt": "2025-10-06T13:10:00Z"
}
```

### ì—ëŸ¬ ì‘ë‹µ

- ì‘ì„±ìê°€ ì•„ë‹Œ ê²½ìš°:

  ```json
  { "detail": "ì‘ì„±ìë§Œ ìˆ˜ì • ê°€ëŠ¥" }
  ```

- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€:

  ```json
  { "detail": "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€" }
  ```

---

## í›„ê¸° ì‚­ì œ (Delete Review)

- **URL**: `/reviews/{rid}`
- **Method**: `DELETE`
- **ì¸ì¦ í•„ìš”**: âœ… (ë¡œê·¸ì¸ ì„¸ì…˜ ì¿ í‚¤ `session`)
- **Path Param**

  | ì´ë¦„  | íƒ€ì…   | ì„¤ëª…                |
  | ----- | ------ | ------------------- |
  | `rid` | string | ì‚­ì œí•  ë¦¬ë·°ì˜ `_id` |

### âœ… ì„±ê³µ ì‘ë‹µ

```json
{ "ok": true }
```

### ì—ëŸ¬ ì‘ë‹µ

- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€:

  ```json
  { "detail": "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€" }
  ```

- ì‘ì„±ìê°€ ì•„ë‹ ë•Œ:

  ```json
  { "detail": "ì‘ì„±ìë§Œ ì‚­ì œ ê°€ëŠ¥" }
  ```

---

## íŒŒì¼ ì €ì¥ êµ¬ì¡° (EC2 ì„œë²„)

| í•­ëª©          | ê²½ë¡œ                            | ì„¤ëª…                                    |
| ------------- | ------------------------------- | --------------------------------------- |
| í›„ê¸° ì €ì¥     | `/home/ubuntu/app/reviews.json` | ëª¨ë“  ë¦¬ë·° ë°ì´í„°                        |
| ì´ë¯¸ì§€ ì €ì¥   | `/home/ubuntu/app/uploads/`     | ì‹¤ì œ ì—…ë¡œë“œëœ íŒŒì¼                      |
| ì •ì  ì„œë¹™ URL | `/static/<íŒŒì¼ëª…>`              | FastAPIê°€ `/uploads` í´ë”ë¥¼ ì™¸ë¶€ ê³µê°œí•¨ |

---

## ì˜ˆì‹œ ìš”ì²­ (Postman or Fetch)

```bash
POST /reviews
Content-Type: multipart/form-data
Cookie: session=<ì„¸ì…˜í† í°>

Body:
  title="í›„ê¸° ì œëª©"
  body="ë³¸ë¬¸ì…ë‹ˆë‹¤"
  files=@cat.jpg
```

ì‘ë‹µ:

```json
{
  "_id": "af12b2c7-8a4f-4b32-933e-9a4c8e8fdd20",
  "title": "í›„ê¸° ì œëª©",
  "body": "ë³¸ë¬¸ì…ë‹ˆë‹¤",
  "images": ["/static/1696614000_af12b2c7.jpg"],
  "authorId": "tester",
  "createdAt": "2025-10-06T13:20:00Z",
  "updatedAt": "2025-10-06T13:20:00Z"
}
```

---

## ìš”ì•½

| ê¸°ëŠ¥           | URL              | Method   | ì„¤ëª…               |
| -------------- | ---------------- | -------- | ------------------ |
| í›„ê¸° ëª©ë¡ ì¡°íšŒ | `/reviews`       | `GET`    | ëª¨ë“  í›„ê¸° ëª©ë¡     |
| í›„ê¸° ë‹¨ê±´ ì¡°íšŒ | `/reviews/{rid}` | `GET`    | íŠ¹ì • í›„ê¸° ìƒì„¸     |
| í›„ê¸° ì‘ì„±      | `/reviews`       | `POST`   | ìƒˆ í›„ê¸° ì‘ì„±       |
| í›„ê¸° ìˆ˜ì •      | `/reviews/{rid}` | `PATCH`  | ìì‹ ì˜ í›„ê¸°ë§Œ ìˆ˜ì • |
| í›„ê¸° ì‚­ì œ      | `/reviews/{rid}` | `DELETE` | ìì‹ ì˜ í›„ê¸°ë§Œ ì‚­ì œ |

---
