# ============================================================
# ğŸ§© merge_job_groups.py
#   - data/A_labeled.csv ë¶ˆëŸ¬ì™€ì„œ ì§ì—…êµ° í†µí•© í›„ ì €ì¥
# ============================================================

import pandas as pd

# ------------------------------------------------------------
# 1ï¸âƒ£ ë°ì´í„° ë¡œë“œ
# ------------------------------------------------------------
path = "data/A_unlabeled.csv"
df = pd.read_csv(path)
print(f"âœ… Loaded {len(df)} samples from {path}")

# ------------------------------------------------------------
# 2ï¸âƒ£ ì§ì—… ì»¬ëŸ¼ ìë™ íƒìƒ‰
# ------------------------------------------------------------
job_cols = [c for c in df.columns if c.startswith("ì§ì—…_")]
print(f"ğŸ¯ Detected job columns: {job_cols}")

# ------------------------------------------------------------
# 3ï¸âƒ£ ì§ì—…êµ° ë§¤í•‘ ì •ì˜
# ------------------------------------------------------------
group_map = {
    "í™”ì´íŠ¸ì¹¼ë¼": ["ì§ì—…_1", "ì§ì—…_2", "ì§ì—…_3"],
    "ë¸”ë£¨ì¹¼ë¼": ["ì§ì—…_4", "ì§ì—…_5", "ì§ì—…_6"],
    "ìì˜ì—…": ["ì§ì—…_7"],
    "ë¹„ê²½ì œí™œë™ì¸µ": ["ì§ì—…_8", "ì§ì—…_9"],
    "ê¸°íƒ€": ["ì§ì—…_10"],
}

# ------------------------------------------------------------
# 4ï¸âƒ£ ì§ì—…êµ°ë³„ í†µí•© ì»¬ëŸ¼ ìƒì„±
# ------------------------------------------------------------
for new_col, cols in group_map.items():
    # í•´ë‹¹ ì§ì—…êµ°ì— í¬í•¨ë˜ëŠ” ì—´ ì¤‘ í•˜ë‚˜ë¼ë„ 1ì´ë©´ 1ë¡œ í‘œì‹œ
    df[new_col] = df[cols].max(axis=1)

# ------------------------------------------------------------
# 5ï¸âƒ£ ì›ë˜ ì§ì—…_* ì—´ ì œê±°
# ------------------------------------------------------------
df.drop(columns=job_cols, inplace=True)

# ------------------------------------------------------------
# 6ï¸âƒ£ ì €ì¥
# ------------------------------------------------------------
output_path = "data/A_labeled_merged.csv"
df.to_csv(output_path, index=False, encoding="utf-8-sig")

print("\nğŸ¯ ì™„ë£Œ â€” ì €ì¥ë¨:")
print(f" - {output_path}")
print(f"ğŸ“Š ìµœì¢… ì»¬ëŸ¼ ìˆ˜: {len(df.columns)}")
print(f"ğŸ“‚ ìƒˆë¡œìš´ ì§ì—…êµ° ì»¬ëŸ¼: {list(group_map.keys())}")
